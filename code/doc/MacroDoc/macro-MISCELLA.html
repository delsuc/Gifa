<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=iso-8859-1">
	<TITLE>Macro programming - MISCELLANEOUS COMMANDS, NOT SPECIFIC BUT US</TITLE>
	<META NAME="GENERATOR" CONTENT="StarOffice/5.2 (Win32)">
	<META NAME="CREATED" CONTENT="20011127;17585428">
	<META NAME="CHANGEDBY" CONTENT="Thierry Gostan">
	<META NAME="CHANGED" CONTENT="20011127;18111186">
	<!-- This document was created from RTF source by rtftohtml version 3.9.3 -->
</HEAD>
<BODY>
<P ALIGN=CENTER STYLE="margin-bottom: 0cm"><A HREF="./macro-CUSTOMIZ.html"><IMG SRC="./images/leftg.gif" NAME="Image1" ALT="Prev " ALIGN=BOTTOM WIDTH=30 HEIGHT=29 BORDER=0></A> 
  <A HREF="./macro-EXAMPLES.html"><IMG SRC="./images/rightg.gif" NAME="Image2" ALT="Next " ALIGN=BOTTOM WIDTH=30 HEIGHT=29 BORDER=0></A> 
  <A HREF="./macro-Contents.html"><IMG SRC="./images/contg.gif" NAME="Image3" ALT="Contents " ALIGN=BOTTOM WIDTH=30 HEIGHT=29 BORDER=0></A> 
</P>
<HR SIZE=4>
<H1>MISCELLANEOUS COMMANDS, NOT SPECIFIC BUT USEFUL IN MACROS</H1>
<UL>
	<LI><P STYLE="margin-bottom: 0cm"><A HREF="#1"><FONT COLOR="#cc0000">For
	control and interaction</FONT></A></P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#2"><FONT COLOR="#cc0000">EXIT,
		QUIT, or BYE</FONT></A></P>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#3"><FONT COLOR="#cc0000">VERBOSE
		and DEBUG</FONT></A></P>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#4"><FONT COLOR="#cc0000">SH,
		Unix calls</FONT></A></P>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#5"><FONT COLOR="#cc0000">CD</FONT></A></P>
	</UL>
	<LI><P STYLE="margin-bottom: 0cm"><A HREF="#6"><FONT COLOR="#cc0000">Error
	Handling</FONT></A></P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#7"><FONT COLOR="#cc0000">ERROR</FONT></A></P>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#8"><FONT COLOR="#cc0000">ONERRORGOTO</FONT></A></P>
	</UL>
	<LI><P STYLE="margin-bottom: 0cm"><A HREF="#9"><FONT COLOR="#cc0000">Code
	Optimisation</FONT></A></P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#10"><FONT COLOR="#cc0000">TIMER</FONT></A></P>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#11"><FONT COLOR="#cc0000">PROFILER</FONT></A></P>
	</UL>
	<LI><P STYLE="margin-bottom: 0cm"><A HREF="#12"><FONT COLOR="#cc0000">Batch
	Mode</FONT></A></P>
	<UL>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#13"><FONT COLOR="#cc0000">In
		VMS</FONT></A></P>
		<LI><P STYLE="margin-bottom: 0cm"><A HREF="#14"><FONT COLOR="#cc0000">In
		UNIX</FONT></A></P>
		<LI><P><A HREF="#15"><FONT COLOR="#cc0000">On All Systems</FONT></A></P>
	</UL>
</UL>
<HR SIZE=4>
<H2><A NAME="1"></A>For control and interaction</H2>
<H3><A NAME="2"></A>EXIT, QUIT, or BYE</H3>
<P STYLE="margin-bottom: 0cm">	These commands, when used within a
macro, simply exit the macro, as a normal exit would do.</P>
<H3><A NAME="3"></A>VERBOSE and DEBUG</H3>
<P STYLE="margin-bottom: 0cm">	These 2 contexts will generate verbose
output from some module in <I>Gifa</I>. For instance <FONT FACE="Courier">VERBOSE</FONT>
will detail the processing of Maximum Entropy run, of macro files, of
baseline correction, of fitter evaluations etc...</P>
<P STYLE="margin-bottom: 0cm">	In DEBUG mode, the name of each macro
is typed on the terminal when the macro is called. This may be very
useful when searching for macros called by a graphic interface. In
DEBUG mode some additional information is also given such as more
detailed error codes, etc...</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3><A NAME="4"></A>SH, Unix calls</H3>
<P STYLE="margin-bottom: 0cm">The SH command will send its parameter
to the operating system. For instance you can type :</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>Gifa&gt;  sh &quot;dir
[marc...]*.ser	&quot;		; on VMS machine</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">or</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>Gifa&gt;  sh &quot;render
upper.uis&quot;			; on VMS machine</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">or</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>Gifa&gt; sh &quot;ls -l
/usr/data&quot;			; on UNIX machine</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">You can also type SH alone, this has
the effect of creating a sub process at the operating system level
(csh is used on a UNIX machine), you then get back to <I>Gifa</I> by
loging out ( logout on VMS, ^D on UNIX).</P>
<P STYLE="margin-bottom: 0cm">	Using SH, several macros have been
created that mimic UNIX : more, rm, ls, vi, pwd, etc... There are
also two special editing command : <FONT FACE="Courier">vip</FONT>
will edit in your $HOME/macro directory, and <FONT FACE="Courier">vim</FONT>
in /usr/local/gifa/macro</P>
<P STYLE="margin-bottom: 0cm">	Note that the function <I>sh()</I>
(new with version 4.4) permits to call the operating system and to
get the value returned by the command.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3><A NAME="5"></A>CD</H3>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier">CD <I>dir</I></FONT>
 permits to change the current working directory to <I><FONT FACE="Courier">dir</FONT></I>
. &nbsp;Equivalent to UNIX. Note that this is very different from :</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>sh 'cd dir'</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">which actually creates a sub-process
which executes cd, thus having no effect on the current job.</P>
<H2><A NAME="6"></A>Error Handling</H2>
<P STYLE="margin-bottom: 0cm">	When an error is encountered, the
program stops the execution and resumes to the user with a specific
message. If the error happens during the execution of a string of
commands on a single line, the string is aborted. If it happens
during a macro, the macro is aborted.</P>
<P STYLE="margin-bottom: 0cm">	Typical error conditions are :</P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	unknown command</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	wrong parameter for a
command (e.g. FT F3 in 2D; SIN 1; FT on real data, etc.. ).</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	A impossible READx or
WRITEx is tried (e.g. READ DATA.001 and DATA.001 does not exist).</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	mistyping a parameter (e.g.
EM 0,5 instead of 0.5 ).</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	a ^C was typed by the user.</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	an ERROR command was
issued.</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	a syntax error was detected
within a () expression, in this case, a graphic pointers show were
the error might be</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	an invlaid string was
interpreted as a number</B></FONT></FONT></P>
<P STYLE="margin-left: 0.5cm; text-indent: -0.46cm; margin-bottom: 0cm">
<FONT FACE="Times"><FONT SIZE=2><B>&#149;	a variable which does not
exists was used.</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">	If the error occurs when the command
was executed from a menu button, a alert box will be displayed.</P>
<H3><A NAME="7"></A>ERROR</H3>
<P STYLE="margin-bottom: 0cm">	This command generates an error during
the execution of the macro. The string given as argument is used to
notify the user. 
</P>
<H3><A NAME="8"></A>ONERRORGOTO</H3>
<P STYLE="margin-bottom: 0cm">	This command modifies the standard
error handling. The command requires an argument, which is a label
within the current macro. After it has been issued, if an error is
generated, the execution of the macro will resume to this label
rather than stopping the macro. It thus permits a gracefull handling
of the error condition.</P>
<P STYLE="margin-bottom: 0cm">	Once the error condition has been
trapped, the <FONT FACE="Courier">ONERRORGOTO</FONT> state is lost,
and must be reset with a new instance of the command. Note also that
the condition is strictly local to the macro. If an error happens in
a called macro, this second macro will stop as normal, and the error
will be handle in the caller.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H2><A NAME="9"></A>Code optimisation</H2>
<P STYLE="margin-bottom: 0cm">	Code optimization can be realized at
several levels. 
</P>
<P STYLE="margin-bottom: 0cm">	First, for data processing, always
choose the commands realizing the processing on the larger possible
piece of data, as this is usually realized in the processing kernel
rather than in macro. For instance, if you want to add two 2D files
(let say) it will be much more efficient to add the 2D at once,
rather than adding row by row.</P>
<P STYLE="margin-bottom: 0cm">	You also have to know that control
structures are somehow compiled when processed the first time, and
the result of this compilation is used for the following passes. This
is true for the <FONT FACE="Courier">FOR .. ENFOR ; WHILE .. ENDWHILE
; IF..ENDIF</FONT> structures, as well as for the <FONT FACE="Courier">GOTO</FONT>.</P>
<P STYLE="margin-bottom: 0cm">	As a matter of speed optimization, you
have to know that macro calling is lengthy, as that your code will be
faster if you manage to put every thing in a given macro; also notice
that calling a macro explicitely with @, and with its full path
(<FONT FACE="Courier">@/usr/local/gifa/macro/speed</FONT> ) is
probably faster than using the implicit call : <FONT FACE="Courier">speed</FONT>.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3><A NAME="10"></A>TIMER</H3>
<P STYLE="margin-bottom: 0cm">The command <FONT FACE="Courier">TIMER</FONT>
permits  the measure of the CPU time spent for a given command. When
<FONT FACE="Courier">TIMER</FONT> is set to 1, each command issued at
the console, or from the Graphic user interface is timed. Timer is
returned as the CPU time used for the process, the system time
(system calls) used and the sum of both.</P>
<P STYLE="margin-bottom: 0cm">If <FONT FACE="Courier">TIMER</FONT> is
reset to 1 during a macro execution, the value is issued and time
counting is reset to zero.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3><A NAME="11"></A>PROFILER profile</H3>
<P STYLE="margin-bottom: 0cm">	The <FONT FACE="Courier">PROFILER</FONT>
command tells you how much time each executed command takes. When set
to 1 during macro processing, each macro line is timed, and the times
are cumulated, permitting to profile exactly the execution of lengthy
macro. Look to <FONT FACE="Courier">PROFILER</FONT> help for details.</P>
<P STYLE="margin-bottom: 0cm">	Alternatively, you may use the <FONT FACE="Courier">profile</FONT>
macro, which uses <FONT FACE="Courier">PROFILER</FONT>, and gives you
a complete analysis of the execution times. Simply type</P>
<P STYLE="margin-bottom: 0cm"><FONT FACE="Courier">profile macro_name</FONT></P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H2><A NAME="12"></A>Batch Mode</H2>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm">	It is perfectly possible to create
files in order to run the program in background.</P>
<H3><A NAME="13"></A>In VMS</H3>
<P STYLE="margin-bottom: 0cm">Here is the structure of such a COM
file (VMS):</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>$ gifa		! this call gifa from the
VMS level</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>dim 2		; now you just type the
commands the way you would do</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>			; in normal interactive
processing</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>read [marc.data]stuff.ser</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>revf f2 sin .3 f12	; you can link
command on one line</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>		; or span on several lines
(different from macros)</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>rft</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>f12</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>@baseline	; even call macros.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>write [marc.data]stuff.smx</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>exit y			; DO NOT forget the exit
at the end.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>$ dir [marc.data]stuff.*/siz	!
we're back to VMS.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>$ exit					! end of the run.</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P STYLE="margin-bottom: 0cm">	You can execute such a macro either in
a pseudo-interactive mode by typing 
</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>$ @name_of_the_COM_file</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">or in batch mode by submitting it to a
batch queue :</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>$ submit name_of_the_COM_file</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">	With this last technic the file is
executed in background, and you do not have to wait for it to be
finished to log out of the system.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3><A NAME="14"></A>In UNIX</H3>
<P STYLE="margin-bottom: 0cm">	On UNIX machines, type a file
containing the command as you would type them and just start <I>Gifa</I>
by &quot;piping&quot; the file as standard input, and the output on
another file. The &amp; sign run the process in background :</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>% gifa &lt; name_of_the_COM_file &gt;
process.out &amp;</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm; line-height: 100%"><BR>
</P>
<P STYLE="margin-bottom: 0cm">DO NOT forget to end the input file
with the final ' EXIT N ' which is the end of a normal interactive
session (or 'EXIT Y' if you wish to keep the log file). Also you may
experience problems if you use interactive shell commands such as
'vi' or even 'more'.</P>
<P STYLE="margin-bottom: 0cm"><BR>
</P>
<H3><A NAME="15"></A>On All Systems</H3>
<P STYLE="margin-bottom: 0cm">	The input in the batch file is entered
to the program as a user would do, so it is different from macro in
at least to points : &#149; control structures are not allowed &#149;
error conditions will not stop the execution, but the program will
continue, So be careful when deleting important files within batch
files!</P>
<P STYLE="margin-bottom: 0cm">	Of course any macro can be called
during the batch process, without any restriction on control
structures.</P>
<P STYLE="margin-bottom: 0cm">	When running in batch mode it is
usually useless (though not forbidden) to activate the display.
However if you want to have <I>Gifa</I> running while you are not
logged on, you should choose a graphic-less mode. This mode is
entered if there is no X_Windows DISPLAY available. For instance with</P>
<P STYLE="margin-bottom: 0cm; line-height: 100%; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Courier"><FONT SIZE=2>unsetenv DISPLAY</FONT></FONT></P>
<P STYLE="margin-bottom: 0cm">Do not forget to adapt a special
startup.g macro (for instance in the current directory) in order not
to launch the standard graphic environment (which would give an error
anyway).</P>
<P STYLE="margin-bottom: 0cm">It is perfectly possible to plot and
print results while in batch mode.</P>
<HR SIZE=4>
<P ALIGN=CENTER><A HREF="./macro-CUSTOMIZ.html"><IMG SRC="./images/leftg.gif" NAME="Image4" ALT="Prev " ALIGN=BOTTOM WIDTH=30 HEIGHT=29 BORDER=0></A> 
  <A HREF="./macro-EXAMPLES.html"><IMG SRC="./images/rightg.gif" NAME="Image5" ALT="Next " ALIGN=BOTTOM WIDTH=30 HEIGHT=29 BORDER=0></A> 
  <A HREF="./macro-Contents.html"><IMG SRC="./images/contg.gif" NAME="Image6" ALT="Contents " ALIGN=BOTTOM WIDTH=30 HEIGHT=29 BORDER=0></A> 
</P>
</BODY>
</HTML>